!function(a,b,c,d){if("function"==typeof define&&define.amd)define(b,c,d);else if("object"==typeof exports&&exports){for(var e=0,f=c.length;f>e;++e){var g=c[e];"string"==typeof g&&(g=g.replace(/([A-Z]+)/g,function(a){return"-"+a.toLowerCase()}).replace(/^-/,""),c[e]=require(g))}var h=d.apply(a,c);for(var i in h)exports[i]=h[i]}else{for(var e=0,f=c.length;f>e;++e){var g=c[e];if("string"==typeof g){if(!(g in a))throw new Error('"'+b+'" dependent on non exited module "'+g+'"!');c[e]=a[g]}}a[b]=d.apply(a,c)}}(new Function("return this")(),"ClazzJS",["MetaJS"],function(a,b){var c=a.meta,d=function(a,b,c){var e=function(a,b,c){var d=arguments[arguments.length-1];return"function"!=typeof d&&"[object Object]"!==Object.prototype.toString.call(d)?e.get(a,b):(e.set(a,b,c),void 0)};for(var f in d.prototype)e[f]=d.prototype[f];return e.getManager=function(){return a},e.getFactory=function(){return b},e.getNamespace=function(){return c},e};d.prototype={constructor:d,get:function(a,b){var c;if(c=this.resolveName(a),!c)throw new Error('Clazz with name "'+a+'" does not exits!');b=b||[];var d=this.getManager(),e=this.getFactory();if(!d.hasClazz(c,b)){var f=d.getMeta(c);d.setClazz(e.create({name:c,dependencies:b,parent:this.adjustParent(f.parent),meta:f.meta}))}return d.getClazz(c,b)},has:function(a){return!!this.resolveName(a)},set:function(a,b,c){var d=this.getNamespace(),e=this.getManager();return"object"==typeof a?(b=a.parent,c=a.meta,a=a.name):"undefined"==typeof c&&(c=b,b=null),a=d.apply(a),e.setMeta(a,{parent:b,meta:c}),this},resolveName:function(a){var b,c,d,e,f=this.getManager(),g=this.getNamespace(),h=[];for(b=g.getPaths(),d=0,e=b.length;e>d;++d){if(c=g.apply(a,b[d]),f.hasMeta(c))return c;h.push(c)}for(d=0,e=h.length;e>d;++d)for(;g.callback(h[d]);)if(f.hasMeta(h[d]))return c;return!1},adjustParent:function(a){return"string"==typeof a&&(a=[a]),"[object Array]"===Object.prototype.toString.call(a)&&(a=this.get(a[0],a[1]||[])),a}};var e=function(a,b,c,f,g,h){h=h||d;var i=function(c,d){var f=new e(a,b,i,c,g),j=new h(a,b,f);return d&&e.setCallback(f,j,d),j};return i.getManager=function(){return a},i.getFactory=function(){return b},i.getBaseNamespace=function(){return c},i.getGlobal=function(){return g},i.getPath=function(){return e.adjust((c?c.getPath():e.getGlobalPath())+(f?e.getDelimiter()+f:""))},i.getPaths=function(){var a=[].concat(this.getPath());return-1===a.indexOf(e.getGlobalPath())&&a.push(e.getGlobalPath()),a},i.apply=function(a,b){return 0===a.search("[\\"+e.DELIMITERS.join("\\")+"]")?e.adjust(a):e.adjust((b||this.getPath())+e.getDelimiter()+a)},i.callback=function(a){return e.executeNextCallback(a)},i};e.DEFAULT_DELIMITER="/",e.DELIMITERS=["\\","/","_","-","."],e._delimiter=null,e._callbacks={},e.setDelimiter=function(a){if(!(a in this.DELIMITERS))throw new Error("Unsupported delimiter");return this._delimiter=a,this},e.getDelimiter=function(){return this._delimiter||this.DEFAULT_DELIMITER},e.getGlobalPath=function(){return this.getDelimiter()},e.adjust=function(a){var b="[\\"+this.DELIMITERS.join("\\")+"]";return a.replace(new RegExp(b+"+","g"),this.getDelimiter()).replace(new RegExp(b+"$"),"")},e.setCallback=function(a,b,c){var d=a.getPath();d in this._callbacks||(this._callbacks[d]=[]),this._callbacks[d].push(function(){c(b,a)})},e.executeNextCallback=function(a){var b,c,d=this.getDelimiter(),e=a.split(d);for(e.pop();e.length;){if(b=e.join(d),b in this._callbacks)return c=this._callbacks[b].shift(),this._callbacks[b].length||delete this._callbacks[b],c(),!0;e.pop()}return!1};var f=function(){if(this.uid=++f.uid,"function"==typeof this.init){var a=this.init.apply(this,Array.prototype.slice.call(arguments));if("undefined"!=typeof a)return a}};f.NAME="__BASE_CLAZZ__",f.DEPENDENCIES=[],f.uid=0,f.parent=null,f.create=function(){var a=arguments;return new this(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10])},f.prototype={parent:null,clazz:f};var g=function(a,b){this._BaseClazz=a||f,this._metaProcessor=b||c.processor("Clazz.Base")},h=0;g.prototype={CLASS_NAME:"Clazz{uid}",create:function(a){var b=a.name||this.generateName(),c=a.parent,d=a.meta,e=a.dependencies||[],f=this.createClazz(b,c);return f.DEPENDENCIES=e,"function"==typeof d&&(d=d.apply(f,e)),d&&this.applyMeta(f,d),f},createClazz:function(a,c){c||(c=this._BaseClazz);var d=function(){var a=c.apply(this,Array.prototype.slice.call(arguments));return"undefined"!=typeof a?a:void 0};for(var e in c)"function"==typeof c[e]?d[e]=c[e]:"_"===e[0]&&(d[e]=b);return d.NAME=a||this.generateName(),d.parent=c,d.prototype=Object.create(c.prototype),d.prototype.clazz=d,d.prototype.parent=c.prototype,d},applyMeta:function(a,b){this._metaProcessor.process(a,b)},combineProcessors:function(){var a,b,c,d,e={clazz:[],proto:[]};for(a=0,b=arguments.length;b>a;++a){d=arguments[a],"[object Array]"===Object.prototype.toString.call(d)&&(d={clazz:d,proto:d});for(c in e)c in d&&(e[c]=e[c].concat(d[c]))}return e},generateName:function(){return this.CLASS_NAME.replace("{uid}",++h)},getMetaProcessor:function(){return this._metaProcessor},getBaseClazz:function(){return this._BaseClazz}};var i=function(){this._clazz={},this._meta={}};i.prototype={setMeta:function(a,b){return this._meta[a]=b,this},hasMeta:function(a){return a in this._meta},getMeta:function(a){if(!this.hasMeta(a))throw new Error('Meta does not exists for "'+a+'"!');return this._meta[a]},getClazz:function(a,b){var c,d,e,f,g,h;if(g=this._clazz[a],"[object Array]"===Object.prototype.toString.apply(g))for(b||(b=[]),c=0,d=g.length;d>c;++c){for(h=!0,e=0,f=g[c].DEPENDENCIES.length;f>e;++e)if(g[c].DEPENDENCIES[e]!==b[e]){h=!1;break}if(h)return g[c]}throw new Error('Clazz "'+a+'" does not exists!')},hasClazz:function(a,b){var c,d,e,f,g,h;if(g=this._clazz[a],"[object Array]"===Object.prototype.toString.apply(g)){if(!b)return!0;for(c=0,d=g.length;d>c;++c){for(h=!0,e=0,f=g[c].DEPENDENCIES.length;f>e;++e)if(g[c].DEPENDENCIES[e]!==b[e]){h=!1;break}if(h)return!0}}return!1},setClazz:function(a,b){if("function"==typeof a&&(b=a,a=b.NAME),"function"!=typeof b)throw new Error("Clazz must be a function!");return a in this._clazz||(this._clazz[a]=[]),this._clazz[a].push(b),this}},c.processor("Clazz.Base",{_types:{clazz:function(a){return a},proto:function(a){return a.prototype}},_processors:{clazz:["Clazz.Clazz"],proto:["Clazz.Proto"]},process:function(a,b){var d=this,e,f,g,h,i,j,k,l,m=a.parent&&"__getMetaProcessors"in a.parent?a.parent.__getMetaProcessors():this._processors,n=b.meta_processors||{},o=[m,n],p={};for(j=0,k=o.length;k>j;++j){l=o[j];for(e in l){e in p||(p[e]=[]),l[e]=[].concat(l[e]);for(h=0,i=l[e].length;i>h;++h)g=l[e][h],"string"==typeof g&&(g=c.processor(g)),g in p[e]||p[e].push(g)}}for(e in p)for(f=d._types[e](a),h=0,i=p[e].length;i>h;++h)p[e][h].process(f,b);a.__getMetaProcessors=function(a){return"undefined"!=typeof a?p[a]:p}},addType:function(a,b){return a in this._processors||(this._processors[a]=[]),this._types[a]=b,this},removeType:function(a){return a in this._processors&&delete this._processors[a],delete this._types[a],this},addProcessor:function(a,b){return this._processors[a].push(b),this},removeProcessor:function(a,b){var c=this._processors[a].indexOf(b);return this._processors[a].splice(c,1),this}}),c.processor("Clazz.Clazz","Meta.Options",{options:{constants:"Clazz.Constants",clazz_properties:"Clazz.Properties",clazz_methods:"Clazz.Methods"}}),c.processor("Clazz.Constants","Meta.Chain",{processors:{init:"Clazz.Constants.Init","interface":"Clazz.Constants.Interface"}}),c.processor("Clazz.Constants.Init",function(a,b){a.__constants={};for(var c in b)a.__constants[c]=b[c]}),c.processor("Clazz.Constants.Interface","Meta.Interface",{"interface":{"const":function(a){return this.__getConstant(a)},__getConstant:function(a,b){var c=this;if("undefined"==typeof b&&(b=c.__getConstants()),"undefined"!=typeof a){if(!(a in b))throw new Error('Constant "'+a+'" does not defined!');if(b=b[a],"[object Object]"===Object.prototype.toString.apply(b))return function(a){return c.__getConstant(a,b)}}return b},__getConstants:function(){for(var a={},b=this;b;){if(b.hasOwnProperty("__constants"))for(var c in b.__constants)c in a||(a[c]=b.__constants[c]);b=b.parent}return a}}}),c.processor("Clazz.Events","Meta.Chain",{processors:{"interface":"Clazz.Events.Interface",init:"Clazz.Events.Init"}}),c.processor("Clazz.Events.Init",function(a,b){var c,d,e;for(c in b)for(d in b[c])a.on(c,d,b[c][d]);for(e=a.parent;e;){if(e.__eventsCallbacks){var b=e.getEventCallbacks();for(c in b)for(d in b[c])a.hasEventCallback(c,d)||a.on(c,d,b[c][d])}e=e.parent}}),c.processor("Clazz.Events.Interface","Meta.Interface",{"interface":{__eventsCallbacks:{},on:function(a,b,c){if(this.hasEventCallback(a,b))throw new Error('Event callback for "'+a+'"::"'+b+'" is already exists!');return a in this.__eventsCallbacks||(this.__eventsCallbacks[a]={}),this.__eventsCallbacks[a][b]=c,this},off:function(a,b){if(!this.hasEventCallback(a,b))throw new Error('There is no "'+a+(b?'"::"'+b:"")+'" event callback!');return"undefined"==typeof b?delete this.__eventsCallbacks[a]:delete this.__eventsCallbacks[a][b],this},hasEventCallback:function(a,b){return a in this.__eventsCallbacks&&("undefined"==typeof b||b in this.__eventsCallbacks[a])},getEventCallback:function(a,b){if(this.hasEventCallback(a,b))throw new Error('Event callback for "'+a+'"::"'+b+'" is not exists!');return this.__eventsCallbacks[a][b]},getEventCallbacks:function(a){return"undefined"!=typeof a?this.__eventsCallbacks[a]||{}:this.__eventsCallbacks},emit:function(a){if(this.hasEventCallback(a))for(var b in this.__eventsCallbacks[a])this.__eventsCallbacks[a][b].apply(this,Array.prototype.slice(1));return this}}}),c.processor("Clazz.Methods",function(a,b){if("function"==typeof a&&a.parent)for(var c in a.parent)"function"==typeof a.parent[c]&&(a[c]=a.parent[c]);for(var c in b){if("function"!=typeof b[c])throw new Error('Method "'+c+'" must be a function!');a[c]=b[c]}}),c.processor("Clazz.Properties","Meta.Chain",{processors:{init:"Clazz.Properties.Init","interface":"Clazz.Properties.Interface",meta:"Clazz.Properties.Meta",defaults:"Clazz.Properties.Defaults"}}),c.processor("Clazz.Properties.Defaults",{DEFAULT:{hash:{},array:[]},process:function(a){var b,c,d,e=a.__properties;for(d in e)c=e[d]["default"],"undefined"==typeof c&&(b=e[d].type,"undefined"!=typeof b&&b in this.DEFAULT&&(c=this.DEFAULT[b])),a["_"+d]=this.__copy(c)}}),c.processor("Clazz.Properties.Init",function(a,c){for(var d in c)a["_"+d]=b}),c.processor("Clazz.Properties.Interface","Meta.Interface",{"interface":{__setters:{},__getters:{},__properties:{},init:function(a){this.__setData(a)},__setProperties:function(a){for(var b in a)this.__setProperty(b,a[b]);return this},__getProperties:function(){for(var a=this,b={};a;){if(a.__properties)for(var c in a.__properties)c in b||(b[c]=a.__properties[c]);a=a.parent}return b},__setProperty:function(a,b,c){if(a=this.__adjustPropertyName(a),"undefined"==typeof this.__properties[a]&&(this.__properties[a]={}),{}.constructor===b.constructor)for(var d in b)this.__properties[a][d]=b[d];else this.__properties[a][b]=c;return this},__getProperty:function(a,b){var c=this.__getProperties();return"undefined"==typeof b?c[a]:c[a]&&c[a][b]},__hasProperty:function(a){return a=this.__adjustPropertyName(a),a in this.__getProperties()},__adjustPropertyName:function(a){return a.replace(/(?:_)\w/,function(a){return a[1].toUpperCase()})},__setData:function(a){for(var b in a)this.__hasProperty(b)&&this.__setPropertyValue(b,a[b]);return this},__getPropertyValue:function(a){var b,c,d,e,f;if(a=this.__adjustPropertyName(a),!this.__hasProperty(a))throw new Error("Can't get! Property \""+a+'" does not exists!');f=this["_"+a],b=this.__getGetters(a);for(e in b)f=b[e].call(this,f);var g="[object Array]"===Object.prototype.toString.call(arguments[1])?arguments[1]:Array.prototype.slice.call(arguments,1);for(c=0,d=g.length;d>c;++c)f=f[g[c]];return f},__setPropertyValue:function(a){var b,c,d,e,f,g,h,i,j,k=arguments[arguments.length-1];if(a=this.__adjustPropertyName(a),!this.__hasProperty(a))throw new Error("Can't set! Property \""+a+'" does not exists!');if(f="[object Array]"===Object.prototype.toString.call(arguments[1])?arguments[1]:Array.prototype.slice.call(arguments,1,-1),f&&f.length){for(g=this["_"+a],h=g,c=0,d=f.length-1;d>c;++c)f[c]in g||(h[f[c]]={}),h=h[f[c]];j=h[f[c]],h[f[c]]=k}else g=k;b=this.__getSetters(a);for(e in b)g=b[e].call(this,g);return i=this["_"+a],this["_"+a]=g,this.__eventsCallbacks&&(this.emit.apply(this,["property.setted",a].concat(f).concat([h||g,j||i])),this.emit("property."+[a].concat(f).join(".")+".setted",h||g,j||i)),this},__isPropertyValue:function(a){var b="[object Array]"===Object.prototype.toString.apply(arguments[1])?arguments[1]:Array.prototype.slice.call(arguments,1),c=this.__getPropertyValue(a,b),d=arguments[arguments.length-1];return"undefined"!=typeof c?c==d:!!c},__hasPropertyValue:function(a){var b="[object Array]"===Object.prototype.toString.apply(arguments[1])?arguments[1]:Array.prototype.slice.call(arguments,1),c=this.__getPropertyValue(a,b);if("[object Object]"===Object.prototype.toString.apply(c)){for(var d in c)return!0;return!1}return!("undefined"==typeof c||null===c||"string"==typeof c&&""===c||"[object Array]"===Object.prototype.toString.apply(c)&&0===c.length)},__addSetter:function(a,b,c){if("undefined"==typeof c&&(c=b,b=0),"function"!=typeof c)throw new Error("Set callback must be a function!");return a in this.__setters||(this.__setters[a]=[]),this.__setters[a].push([b,c]),this},__getSetters:function(a){for(var b,c,d,e,f={},g=this.clazz.prototype;g;){if(g.hasOwnProperty("__setters"))for(e in g.__setters)e in f||(f[e]=g.__setters[e]);g=g.parent}if("undefined"!=typeof a){if(d=[],a in f&&f[a].length)for(f[a].sort(function(a,b){return b[0]-a[0]}),b=0,c=f[a].length;c>b;++b)d.push(f[a][b][1])}else d=f;return d},__addGetter:function(a,b,c){if("undefined"==typeof c&&(c=b,b=0),"function"!=typeof c)throw new Error("Get callback must be a function!");return a in this.__getters||(this.__getters[a]=[]),this.__getters[a].push([b,c]),this},__getGetters:function(a){for(var b,c,d,e,f={},g=this.clazz.prototype;g;){if(g.hasOwnProperty("__getters"))for(d in g.__getters)d in f||(f[d]=g.__getters[d]);g=g.parent}if("undefined"!=typeof a){if(e=[],a in f&&f[a].length)for(f[a].sort(function(a,b){return b[0]-a[0]}),b=0,c=f[a].length;c>b;++b)e.push(f[a][b][1])}else e=f;return e}}}),c.processor("Clazz.Properties.Meta",function(a,b){for(var d in b){var e=b[d];"[object Array]"===Object.prototype.toString.call(e)?b[d]=e=3===e.length?{type:[e[0],e[2]],"default":e[1]}:{type:e}:("object"!=typeof e||null===e)&&(b[d]=e={"default":e}),"methods"in e||(e.methods=["get","set","has","is"]),c.processor("Clazz.Property").process(a,e,d)}}),c.processor("Clazz.Property","Meta.Options",{options:{type:"Clazz.Property.Type","default":"Clazz.Property.Default",methods:"Clazz.Property.Methods",converters:"Clazz.Property.Converters",constraints:"Clazz.Property.Constraints"}}),c.processor("Clazz.Property.Constraints",function(a,b,c){a.__addSetter(c,function(a){for(var c in b)if(!b[c].call(this,a))throw new Error('Constraint "'+c+'" was failed!');return a})}),c.processor("Clazz.Property.Converters",function(a,b,c){a.__addSetter(c,1e3,function(a){for(var c in b)a=b[c].call(this,a);return a})}),c.processor("Clazz.Property.Default",function(a,b,c){"function"==typeof b&&(b=b()),a.__setProperty(c,"default",b)}),c.processor("Clazz.Property.Methods",{process:function(a,b,c){"[object Array]"!==Object.prototype.toString.apply(b)&&(b=[b]);for(var d=0,e=b.length;e>d;++d)this.addMethod(b[d],a,c)},addMethod:function(a,b,c){var d=this.createMethod(a,c);b[d.name]=d.body},createMethod:function(a,b){if(!(a in this.METHODS))throw new Error('Unsupported method "'+a+'"!');var c=this.METHODS[a](b);return"function"==typeof c&&(c={name:a+b[0].toUpperCase()+b.slice(1),body:c}),c},METHODS:{get:function(a){return function(){return this.__getPropertyValue.apply(this,[a].concat(Array.prototype.slice.call(arguments)))}},set:function(a){return function(b){return this.__setPropertyValue.apply(this,[a].concat(Array.prototype.slice.call(arguments)))}},is:function(a){return{name:(0!==a.indexOf("is")?"is"+a[0].toUpperCase():""+a[0])+a.slice(1),body:function(){return this.__isPropertyValue.apply(this,[a].concat(Array.prototype.slice.call(arguments)))}}},has:function(a){return function(){return this.__hasPropertyValue.apply(this,[a].concat(Array.prototype.slice.call(arguments)))}}}}),c.processor("Clazz.Property.Type",{process:function(a,b,c){var d=this,e={};if("[object Array]"===Object.prototype.toString.apply(b)&&(e=b[1]||[],b=b[0]),!(b in this.TYPES))throw new Error('Unsupported property type "'+b+'"!');a.__setProperty(c,"type",b),a.__addSetter(c,function(a){return d.checkValue(a,b,e,c)})},checkValue:function(a,b,c,d){return this.TYPES[b].call(this,a,c,d)},TYPES:{"boolean":function(a){return Boolean(a)},number:function(a,b){if(a=Number(a),"min"in b&&a<b.min)throw new Error('Value "'+a+'" must not be less then "'+b.min+'"!');if("max"in b&&a>b.max)throw new Error('Value "'+a+'" must not be greater then "'+b.max+'"!');return a},string:function(a,b){if(a=String(a),"pattern"in b&&!b.pattern.test(a))throw new Error('Value "'+a+'" does not match pattern "'+b.pattern+'"!');if("variants"in b&&-1===b.variants.indexOf(a))throw new Error('Value "'+a+'" must be one of "'+b.variants.join(", ")+'"!');return a},datetime:function(a){return!isNaN(a)&&("number"==typeof a||a instanceof Number)?a=new Date(a):("string"==typeof a||a instanceof String)&&(a=new Date(Date.parse(a))),a},object:function(a,b,c){if("object"!=typeof a||"[object Array]"===Object.prototype.toString.call(a))throw new Error('Incorrect value: not object type for property "'+c+'"!');if("instanceof"in b){var d=b.instanceof;if("[object Array]"===Object.prototype.toString.call(d)&&(d=m(d[0],d[1]||[])),!(a instanceof d))throw new Error('Value does not instance of clazz "'+d.NAME+'"!')}return a},array:function(a,b){return"string"==typeof a?a.split(b.delimiter||","):[].concat(a)},hash:function(a,b,c){if({}.constructor!==a.constructor)throw new Error('Incorrect value: not hash type for property "'+c+'"!');if("keys"in b)for(var d in a)if(!(d in b.keys))throw new Error('Unsupported hash key "'+d+'"!');return"element"in b&&this.checkValue.apply(this,[].concat(b.element)),a},clazz:function(a,b,c){if(!("function"==typeof a&&"NAME"in a&&"parent"in a))throw new Error('Incorrect value: not clazz type for property "'+c+'"!');return a}}}),c.processor("Clazz.Proto","Meta.Options",{options:{properties:"Clazz.Properties",methods:"Clazz.Methods",events:"Clazz.Events"}});var j=new g(f,c.processor("Clazz.Base")),k=new i,l=new e(k,j,null,"",new Function("return this")(),d),m=l();return{Base:f,Mangaer:i,Namespace:e,Clazz:d,namespace:l,clazz:m}});
//# sourceMappingURL=dist/ClazzJS.min.map